<div class="row mt-5">
  <% @posts.each do |post| %>
    <div class="col-10 col-sm-8 col-lg-6 offset-1 offset-sm-2 offset-lg-1 col-xl-5 offset-xl-2 card shadow p-0 mb-3">
      <div class="d-flex">
        <%= image_tag User.find(post.user_id).image, class:"ml-4 ml-xl-5 my-4 mr-3", style:"width: 3.6rem; height: 3.6rem;" %>
        <div class="w-100">
          <div class="d-flex justify-content-between mt-3 mr-3 mb-3 mr-lg-5">
            <% if post.like_id.present? %>
              <% if post.theater_id.present? %>
                <div>
                  <p class="mt-3 mb-4"><%= User.find(post.user_id).name %></p>
                  <%= link_to theater_path(post.theater_id), class:"text-decoration-none text-dark" do %>
                    <i class="fas fa-star mr-3 fa-lg" style="color: #FF8300;"></i>
                    <label class=""><i class="fas fa-book-open fa-2x mr-3"></i></label>
                    <p class="d-inline">
                      <strong><%= Theater.find(post.theater_id).title %></strong>
                      をお気に入りに登録しました
                    </p>
                  <% end %>
                </div>
              <% elsif post.movie_id.present? %>
                <div>
                  <p class="mt-3 mb-4"><%= User.find(post.user_id).name %></p>
                  <%= link_to movie_path(post.movie_id), class:"text-decoration-none text-dark" do %>
                    <i class="fas fa-star mr-3 fa-lg" style="color: #FF8300;"></i>
                    <i class="fas fa-film fa-2x mr-3"></i>
                    <p class="d-inline">
                      <strong><%= Movie.find(post.movie_id).title %></strong>
                      をお気に入りに登録しました
                    </p>
                  <% end %>
                </div>
              <% elsif post.stage_id.present? %>
                <div>
                  <p class="mt-3 mb-4"><%= User.find(post.user_id).name %></p>
                  <%= link_to stage_path(post.stage_id), class:"text-decoration-none text-dark" do %>
                    <i class="fas fa-star mr-2 fa-lg" style="color: #FF8300;"></i>
                    <label class=""><i class="fas fa-theater-masks fa-2x mr-2"></i></label>
                    <p class="d-inline">
                      <strong><%= Theater.find(Stage.find(post.stage_id).theater_id).title %></strong>
                      をお気に入りに登録しました
                    </p>
                  <% end %>
                </div>
              <% end %>
            <% elsif post.theater_id.present? && post.like_id.nil? %>
              <div>
                <p class="mt-3 mb-4"><%= User.find(post.user_id).name %></p>
                <label class="badge badge-primary mr-3 p-sm-2 p-1">New</label>
                <label class=""><i class="fas fa-book-open fa-4x"></i></label>
                <p class="mt-2">新しい戯曲を登録しました</p>
              </div>
              <div class="d-flex align-items-end">
                <div class="card h-100 shadow-sm mt-2" style="width: 18rem;">
                  <div class="card-header">
                    <%= Country.find((Theater.find(post.theater_id)).country_id).name %>
                    <div class="float-right">
                      <% if (Theater.find(post.theater_id)).man.nil? && (Theater.find(post.theater_id)).female.nil? %>
                        <%= link_to "未登録", edit_theater_path(post.theater_id), class:"badge badge-pill badge-warning text-light py-2", style:"background-color: #FF8300; font-size: 0.8rem;" %>
                      <% else %>
                        男<%= (Theater.find(post.theater_id)).man%>
                        女<%= (Theater.find(post.theater_id)).female%>
                      <% end %>
                    </div>
                  </div>
                  <div class="card-body">
                    <%= link_to theater_path(post) do %>
                      <p class="card-title text-dark" style="font-size:1.8rem;"><%= (Theater.find(post.theater_id)).title %></p>
                    <% end %>
                    <p class="card-text"><%= (Theater.find(post.theater_id)).writer %></p>
                  </div>
                  <div class="card-footer">
                    <%= link_to favorite_theater_path(post.theater_id), method: :post, remote: true, style:"color: #FF8300;" do %>
                      <div id="favorite-theater-<%= post.theater_id %>">
                        <%= render partial: "theaters/favorite", locals: {theater: Theater.find(post.theater_id)} %>
                      </div>
                    <% end %>
                  </div>
                </div>
              </div>
            <% elsif post.movie_id.present? && post.like_id.nil? %>
              <div>
                <p class="mt-3 mb-3"><%= User.find(post.user_id).name %></p>
                <label class="badge badge-primary mr-3 p-sm-2 p-1">New</label>
                <label class=""><i class="fas fa-film fa-5x"></i></label>
                <p class="mt-2">新しい映画を登録しました</p>
              </div>
              <div class="d-flex align-items-end">
                <div class="card h-100 shadow-sm mt-2" style="width: 18rem;">
                  <div class="card-header">
                    <%= Country.find((Movie.find(post.movie_id)).country_id).name %>
                    <div class="float-right">
                      <%= Movie.find(post.movie_id).production.year %>年
                    </div>
                  </div>
                  <div class="card-body">
                    <%= link_to movie_path(post) do %>
                      <p class="card-title text-dark" style="font-size:1.8rem;"><%= (Movie.find(post.movie_id)).title %></p>
                    <% end %>
                    <p class="card-text"><%= (Movie.find(post.movie_id)).sub_title %></p>
                  </div>
                  <div class="card-footer">
                    <%= link_to favorite_movie_path(post.movie_id), method: :post, remote: true, style:"color: #FF8300;" do %>
                      <div id="favorite-movie-<%= post.movie_id %>">
                        <%= render partial: "movies/favorite", locals: {movie: Movie.find(post.movie_id)} %>
                      </div>
                    <% end %>
                  </div>
                </div>
              </div>
            <% elsif post.stage_id.present? && post.like_id.nil? %>
              <div>
                <p class="mt-3 mb-4 pb-1"><%= User.find(post.user_id).name %></p>
                <label class="badge badge-primary mr-3 p-sm-2 p-1">New</label>
                <label class=""><i class="fas fa-theater-masks fa-4x"></i></label>
                <p class="mt-2">新しい舞台を登録しました</p>
              </div>
              <div class="d-flex align-items-end">
                <div class="card h-100 shadow-sm mt-2" style="width: 18rem;">
                  <div class="card-header">
                    <% if Stage.find(post.stage_id).start_date < Date.today && Stage.find(post.stage_id).end_date > Date.today %>
                      <label class="badge badge-pill badge-warning text-light py-1" style="background-color: #FF8300;">Now</label>
                    <% end %>
                    <%= Stage.find(post.stage_id).start_date.mon %>月<%= Stage.find(post.stage_id).start_date.day %>日
                    〜
                    <% if Stage.find(post.stage_id).start_date.mon != Stage.find(post.stage_id).end_date.mon %>
                      <%= Stage.find(post.stage_id).end_date.mon %>月
                    <% end %>
                    <%= Stage.find(post.stage_id).end_date.day %>日
                  </div>
                  <div class="card-body">
                    <%= link_to stage_path(post) do %>
                      <p class="card-title text-dark" style="font-size:1.8rem;"><%= (Theater.find(Stage.find(post.stage_id).theater_id)).title %></p>
                    <% end %>
                    <p class="card-text"><%= (Stage.find(post.stage_id)).company %></p>
                  </div>
                  <div class="card-footer">
                    <%= link_to favorite_stage_path(post.stage_id), method: :post, remote: true, style:"color: #FF8300;" do %>
                      <div id="favorite-stage-<%= post.stage_id %>">
                        <%= render partial: "stages/favorite", locals: {stage: Stage.find(post.stage_id)} %>
                      </div>
                    <% end %>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
        <div class="card-footer d-none">
          <%= link_to favorite_post_path(post), method: :post, remote: true, style:"color: #FF8300;" do %>
            <div id="favorite-post-<%= post.id %>">
              <% if current_user.likes?(post) %>
                <i class="fas fa-star"></i>
              <% else %>
                <i class="far fa-star"></i>
              <% end %>
            </div>
          <% end %>
        </div>
    </div>
  <% end %>
</div>